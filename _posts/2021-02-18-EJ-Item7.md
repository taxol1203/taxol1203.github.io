---
title: "Effective Java - Item 7"
last_modified_at: 2021-02-18 T22:17:00-05:00
toc: true
toc_sticky: true
header:
  teaser: /images/effective_Java.png
categories: 
  - Effective Java
tags:
---

> Effective Java

Item 7. 다 쓴 객체 참조를 해제하라
=============
## 메모리 누수
자바는 C, C++와 달리 메모리를 직접 관리하지 않아도 Garbage Collection를 통해 손쉽게 메모리를 관리할 수 있다.  
하지만, 자칫 메모리 관리에 더 이상 신경 쓰지 않아도 된다고 오해할 수 있는데, 오산이다.  
### 직접 구현한 Stack의 메모리 누수
```java
import java.util.Arrays;
import java.util.EmptyStackException;

public class Stack {
    private Object[] elements;
    private int size = 0;
    private static final int DEFAULT_INITIAL_CAPACITY = 16;

    public Stack() {
      elements = new Object[DEFAULT_INITIAL_CAPACITY];
    }

    public void push(Object e) {
      ensureCapacity();
      elements[size++] = e;
    }

    public Object pop() {
        if (size == 0)
          throw new EmptyStackException();
        return elements[--size];          // 메모리 누수가 일어난다!!
    }

    private void ensureCapacity() {
        if (elements.length == size)
          elements = Arrays.copyOf(elements, 2 * size);
    }
}
```
특별한 문제는 없어보이지만, 숨어있는 문제가 존재한다.  
바로 '메모리 누수'로, 이 스택을 사용하는 프로그램을 오래 실행하다 보면 점차 GC활동과 메모리 사용량이 늘어나 결국 성능이 저하될 것이다.  
심할 때는 [Disk Paging](http://www.terms.co.kr/paging.htm)이나 [OutOfMemoryError](https://sejoung.github.io/2019/03/2019-03-20-Understand_the_OutOfMemoryError_Exception/#%EA%B0%9D%EC%B2%B4-%EB%B3%B4%EB%A5%98-%EC%A4%91-Finalization-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81)를 일으켜 프로그램이 예기치 않게 종료되기도 한다.  




## 정리

## 출처
Joshua Bloch. Effective Java 3/E. n.p.: 인사이트, 2018년 11월 1일.  